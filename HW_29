import sqlite3
import os

from typing import List, Set

db_pass = os.path.join(os.getcwd(), 'chinook.db')
connection = sqlite3.connect(db_pass)

print(db_pass)
def excute_query(connection,
query_sql: str) ->List:
    cur = connection.cursor()
    result = cur.execute(query_sql)
    return result
def unwrapp_query_result(records: List) -> None:
    '''
    функцияя для красивого вывода результата в консоль
    :param список строк
    '''
    for record in records:
        print(*record)
def get_employees():
    '''
     Функция которая выведет все записи из таблицы sql
    '''
    query_sql = f'''
        SELECT
            FROM employees;
    '''
    result = excute_query(connection, query_sql)
    unwrapp_query_result(result)
def get_unique_customers() -> Set:
    query_sql = f'''
        SELECT FirstName
            FROM customers
'''

    records = excute_query(connection, query_sql)
    unique_names = set()
    for record in records:
        unique_names.add(record[0])
    return unique_names

new_list = {i: list(get_unique_customers()).count(i) for i in get_unique_customers()}
print(new_list)
